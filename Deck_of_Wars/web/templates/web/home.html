{% extends 'web/base.html' %} {% load static %} {% block extra_css %}
<link rel="stylesheet" href="{% static 'web/css/main-menu.css' %}" />
{% endblock %} {% block content %}
<!-- Messages Display -->
{% if messages %} {% for message in messages %}
<div class="alert alert-info alert-dismissible fade show" role="alert">
  {{ message }}
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{% endfor %} {% endif %} {% if user.is_authenticated %}
<!-- Authenticated User Section -->
<div class="container-fluid game-container">
  <div class="row justify-content-center">
    <div class="col-12">
      <!-- Game Title -->
      <div class="text-center mb-4">
        <h1 class="game-title">
          <span class="title-power">POWER</span>
          <span class="title-clash">CLASH</span>
        </h1>
      </div>

      <!-- Main Menu Buttons -->
      <div class="menu-container mb-4">
        <a href="{% url 'Create' %}" class="comic-button btn-create">
          <i class="fas fa-users"></i> Create a Team
        </a>
        <a href="{% url 'Join' %}" class="comic-button btn-join">
          <i class="fas fa-hand-rock"></i> Join a Team
        </a>
        <button class="comic-button btn-rules" onclick="openRules()">
          <i class="fas fa-book"></i> Rules
        </button>
        <button
          class="comic-button btn-achievements"
          onclick="showAchievements()"
        >
          <i class="fas fa-trophy"></i> Achievements
        </button>
      </div>

      <!-- Logout Section -->
      <div class="text-center">
        <form action="{% url 'logout' %}" method="post" class="d-inline">
          {% csrf_token %}
          <button type="submit" class="btn-logout">
            <i class="fas fa-sign-out-alt me-2"></i> Log Out
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

{% else %}
<!-- Not Authenticated Section -->
<div class="container-fluid login-container">
  <div class="row justify-content-center align-items-center min-vh-100">
    <div class="col-12">
      <div class="text-center">
        <!-- Game Title -->
        <h1 class="game-title mb-4">
          <span class="title-power">POWER</span>
          <span class="title-clash">CLASH</span>
        </h1>

        <!-- Welcome Message -->
        <p class="login-message lead mb-5">
          Welcome! Please log in to start playing Power Clash.
        </p>

        <!-- Login Options -->
        <div class="login-options">
          <div class="menu-container">
            <a href="{% url 'login' %}" class="comic-button btn-login">
              <i class="fas fa-sign-in-alt"></i> Log In
            </a>
            <a href="{% url 'register' %}" class="comic-button btn-register">
              <i class="fas fa-user-plus"></i> Register
            </a>
            <a
              href="{% url 'guest_login' %}"
              class="comic-button btn-guest"
              style="grid-column: 1 / -1"
            >
              <i class="fas fa-user"></i> Play as Guest
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}

<!-- Rules Panel (Overlay) -->
<div class="rules-panel" id="rulesPanel" style="display: none">
  <h2>GAME RULES</h2>
  <div class="rules-content">
    <h3>Setup</h3>
    <p>
      <ul>
        <li>Each deck contains 40 cards → 35 Normal Cards, 5 Power Cards</li>
        <li>  The game supports 2 to 4 players</li>
        <li>Each player is dealt 10 cards at the start of the game</li>
        <li>These may include Power Cards (distribution is random and based on luck)</li>
      </ul>
    </p>

    <h3>Objective</h3>
    <p>
      <li>
        The goal of the game is to collect the most cards by the end of the game
      </li>
    </p>

    <h3>Gameplay</h3>
    <h4>Turn Order</h4>
      <li>The game is played in turns in any rotation</li>
    <h4>Playing a Card</h4>
      <li>On their turn, a player chooses one card and selects one stat from it</li>
      <li>All other players compare the same stat from their cards: <br>
        For number stats → the highest number wins <br>
        For Rank stat → the lowest rank wins</li>
      <li>The winning player takes the other players' cards.</li>
    <h4>Special feature</h4>
        <li>Players may choose to play two normal cards at the same time (Power Cards cannot be used this way)</li>
        <li>If the chosen stat is Rank: <br>
        Subtract the ranks <br>
        The lowest result wins <br>
        In case of a draw → both cards go to the dump pile</li>
        <li>If the chosen stat is any other number: <br>
        Add the numbers <br>
        The highest result wins <br>
        In case of a draw → both cards go to the dump pile</li>


    <h3>Power Cards</h3>
    <ul>
      <li>Power Cards have the highest priority when played</li>
      <li>If two players play Power Cards at the same time, both cards are wasted, and the other players return their cards to their decks</li>
      <h4>Power Card Types:</h4>
      <li>Nullify → Sends one chosen player's card back to the deck</li>
      <li>Card Revive → Revives one of your cards (chosen randomly by luck). The revived card is placed back into your playing deck</li>
      <li>Reveal → Reveals all the cards of one chosen player</li>
      <li>Deck Swap → Swap your entire deck with another player</li>
      <li>Card Swap → Swap any 2 cards with another player</li>
      <br>
      <li>⚠ Note: All Power Cards must be played during the game. This means some Normal Cards may remain unused</li>
    </ul>

    <h3>Draw Rules</h3>
    <ul>
      <li> If two players tie for a winning stat → each takes 1 card from the other</li>
      <li>If three or four players tie → the tied cards are shuffled back, and the round is replayed</li>
    </ul>

    <h3>Victory</h3>
    <ul>
      <li>The game continues until all Power Cards have been used</li>
      <li>The player with the most cards at the end of the game is declared the winner.</li>
    </ul>
  </div>
  <button class="close-btn" onclick="closeRules()">Close</button>
</div>

<!-- Achievements Panel (Overlay) -->
<div class="achievement-panel" id="achievementsPanel" style="display: none">
<div class="cross-btn" onclick="closeAchievements()"> <img src="{% static 'web/assets/cross.png' %}" alt="Close"></div>
<!-- <h2>ACHIEVEMENTS</h2> -->
  </div>

<!-- Backdrop for Rules panel -->
<div
  class="rules-backdrop"
  id="rulesBackdrop"
  style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
  "
  onclick="closeRules(); closeAchievements();"
></div>

{% endblock %} {% block extra_js %}
<script src="{% static 'web/javascript/main-menu.js' %}"></script>
{% endblock %}
